\hypertarget{_thread_pool_8h_source}{}\doxysection{Thread\+Pool.\+h}
\label{_thread_pool_8h_source}\index{D:/Documents/Final/Mandelbrot\_Cpp\_Final/src/ThreadPool.h@{D:/Documents/Final/Mandelbrot\_Cpp\_Final/src/ThreadPool.h}}
\mbox{\hyperlink{_thread_pool_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00001}00001 \textcolor{preprocessor}{\#ifndef C\_\_\_\_THREADPOOL\_H\_}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00002}00002 \textcolor{preprocessor}{\#define C\_\_\_\_THREADPOOL\_H\_}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00004}00004 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_unbounded_queue_8h}{UnboundedQueue.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00006}00006 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00007}00007 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00008}00008 \textcolor{preprocessor}{\#include <queue>}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00009}00009 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00010}00010 \textcolor{preprocessor}{\#include <atomic>}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00011}00011 \textcolor{preprocessor}{\#include <future>}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00016}\mbox{\hyperlink{class_thread_pool}{00016}} \textcolor{keyword}{class }\mbox{\hyperlink{class_thread_pool}{ThreadPool}}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00017}00017 \{}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00018}00018  \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00020}00020   \textcolor{keyword}{explicit} \mbox{\hyperlink{class_thread_pool_aedd843c3e9758cf001137884c8b5f219}{ThreadPool}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} numThreads);}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00022}00022   \mbox{\hyperlink{class_thread_pool_a44d3d2ab618970605e684efc216655eb}{\string~ThreadPool}}();}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00024}00024   \textcolor{keyword}{template}<\textcolor{keyword}{typename} T, \textcolor{keyword}{typename}... ARGS>}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00025}\mbox{\hyperlink{class_thread_pool_adae7f97614c6f912c1137b81a486a189}{00025}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_thread_pool_adae7f97614c6f912c1137b81a486a189}{enqueue\_work}}(T\&\& t, ARGS\&\&... args)}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00026}00026   \{}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00027}00027     \textcolor{keyword}{auto} work = [proc = std::forward<T>(t), tuple = std::make\_tuple(std::forward<ARGS>(args)...)]}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00028}00028         () \{std::apply(proc, tuple);\};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00030}00030     \textcolor{keyword}{auto} i = \mbox{\hyperlink{class_thread_pool_ad2aee0123343e802b9b7d68fa96a5a30}{index}}++;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00032}00032     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} j = 0; j < \mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{count}} * \mbox{\hyperlink{class_thread_pool_a9326b3e24cdecf9d9a9aed78eecf2b62}{countMult}}; j++)}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00033}00033     \{}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00034}00034       \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_thread_pool_a30c5829b3d679337b9c6483406bdbbfa}{queues}}[(i + j) \% \mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{count}}].try\_push(work))}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00035}00035       \{}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00036}00036         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00037}00037       \}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00038}00038     \}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00040}00040     \mbox{\hyperlink{class_thread_pool_a30c5829b3d679337b9c6483406bdbbfa}{queues}}[i \% \mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{count}}].push(std::move(work));}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00041}00041   \}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00043}00043   \textcolor{keyword}{template}<\textcolor{keyword}{typename} T, \textcolor{keyword}{typename}... ARGS>}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00044}\mbox{\hyperlink{class_thread_pool_a8bf329f0b10dad25bc75edfd120be8de}{00044}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_thread_pool_a8bf329f0b10dad25bc75edfd120be8de}{enqueue\_task}}(T\&\& t, ARGS\&\&... args)}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00045}00045   \{}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00046}00046     \textcolor{keyword}{using} taskReturnType = std::invoke\_result<T, ARGS...>;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00047}00047     \textcolor{keyword}{using} taskType = std::packaged\_task<taskReturnType()>;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00049}00049     \textcolor{keyword}{auto} task = std::make\_shared<taskType>(std::bind(std::forward<T>(t), std::forward<ARGS>(args)...));}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00050}00050     \textcolor{keyword}{auto} work = [=] () \{(*task)();\};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00051}00051     \textcolor{keyword}{auto} result = task-\/>get\_future();}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00053}00053     \textcolor{keyword}{auto} i = \mbox{\hyperlink{class_thread_pool_ad2aee0123343e802b9b7d68fa96a5a30}{index}}++;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00055}00055     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} j = 0; j < \mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{count}} * \mbox{\hyperlink{class_thread_pool_a9326b3e24cdecf9d9a9aed78eecf2b62}{countMult}}; j++)}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00056}00056     \{}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00057}00057       \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_thread_pool_a30c5829b3d679337b9c6483406bdbbfa}{queues}}[(i + j) \% \mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{count}}].try\_push(work))}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00058}00058       \{}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00059}00059         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00060}00060       \}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00061}00061     \}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00063}00063     \mbox{\hyperlink{class_thread_pool_a30c5829b3d679337b9c6483406bdbbfa}{queues}}[i \% \mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{count}}].push(std::move(work));}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00065}00065     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00066}00066   \}}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00068}00068  \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00070}\mbox{\hyperlink{class_thread_pool_af0bd900e7e9b68e59bba6e892254e879}{00070}}   \textcolor{keyword}{using} \mbox{\hyperlink{class_thread_pool_af0bd900e7e9b68e59bba6e892254e879}{process}} = std::function<void(\textcolor{keywordtype}{void})>;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00072}\mbox{\hyperlink{class_thread_pool_a46a9db5ee7d54ae42a4e89608e7ce173}{00072}}   \textcolor{keyword}{using} \mbox{\hyperlink{class_unbounded_queue}{queue}} = \mbox{\hyperlink{class_unbounded_queue}{UnboundedQueue<process>}};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00074}\mbox{\hyperlink{class_thread_pool_a779f158be1a59c5803b2a150dcaf17ee}{00074}}   \textcolor{keyword}{using} \mbox{\hyperlink{class_thread_pool_a779f158be1a59c5803b2a150dcaf17ee}{queueVec}} = std::vector<queue>;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00076}\mbox{\hyperlink{class_thread_pool_a30c5829b3d679337b9c6483406bdbbfa}{00076}}   \mbox{\hyperlink{class_thread_pool_a779f158be1a59c5803b2a150dcaf17ee}{queueVec}} \mbox{\hyperlink{class_thread_pool_a30c5829b3d679337b9c6483406bdbbfa}{queues}};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00079}\mbox{\hyperlink{class_thread_pool_a1f2fded818c2ab9d18c03eb715ce74cc}{00079}}   \textcolor{keyword}{using} \mbox{\hyperlink{class_thread_pool_a1f2fded818c2ab9d18c03eb715ce74cc}{Threads}} = std::vector<std::thread>;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00081}\mbox{\hyperlink{class_thread_pool_a0880895adaacfea1e563354212cb1345}{00081}}   \mbox{\hyperlink{class_thread_pool_a1f2fded818c2ab9d18c03eb715ce74cc}{Threads}} \mbox{\hyperlink{class_thread_pool_a0880895adaacfea1e563354212cb1345}{threads}};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00082}00082 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00084}\mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{00084}}   \textcolor{keyword}{const} std::size\_t \mbox{\hyperlink{class_thread_pool_ae2964ed8247aa43dd092461ac37e7aaa}{count}};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00086}\mbox{\hyperlink{class_thread_pool_ad2aee0123343e802b9b7d68fa96a5a30}{00086}}   std::atomic\_uint \mbox{\hyperlink{class_thread_pool_ad2aee0123343e802b9b7d68fa96a5a30}{index}} = 0;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00088}\mbox{\hyperlink{class_thread_pool_a9326b3e24cdecf9d9a9aed78eecf2b62}{00088}}   \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_thread_pool_a9326b3e24cdecf9d9a9aed78eecf2b62}{countMult}} = 2;}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00089}00089 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00090}00090 \};}
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{_thread_pool_8h_source_l00092}00092 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//C\_\_\_\_THREADPOOL\_H\_}}

\end{DoxyCode}
